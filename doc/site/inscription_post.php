<?php session_start(); ?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml">	<head>		<meta http-equiv="Content-Type" lang="fr" content="text/html; charset=UTF-8" />		<title>Fu(X) 2.0 - Inscription</title>		<link rel="stylesheet" type="text/css" href="./Styles/style.css" media="screen" />		<link rel="icon" type="image/png" href="images/play.png" />	</head>	<body>		<?php			include("menu.php");			require("bdd.php");		?>					<div id="corps">			<?php $page_actuelle='inscription_post.php'; include("droite.php"); ?>			<div id="milieu">				<div id="description">					<h3>Inscription</h3><!-- site, citation -->				<?php											$b_pseudo = !empty($_POST['pseudo']);					$b_mdp = !empty($_POST['mdp']);					$b_mdp2 = !empty($_POST['mdp2']);					$b_mdpIdentique = false;					$b_mail = !empty($_POST['mail']);					$b_site = !empty($_POST['site']);					$b_siteOK = true;										$mdp = htmlentities($_POST['mdp'], ENT_QUOTES, 'UTF-8');					$mdp2 = htmlentities($_POST['mdp2'], ENT_QUOTES, 'UTF-8');					$mail = htmlentities($_POST['mail'], ENT_QUOTES, 'UTF-8');					$site = htmlentities($_POST['site'], ENT_QUOTES, 'UTF-8');										if (strcmp($mdp, $mdp2) == 0)						$b_mdpIdentique = true;										if (!preg_match('#^[\w.-]+@[\w.-]+\.[a-zA-Z]{2,6}$#', $mail)) // Test si le mail est valide dans la forme						$b_mail = false;											if ($b_site && !preg_match('#http://+[\w.-]+\.[a-zA-Z]{2,6}$#', $site)) // Test si le site est valide dans la forme						$b_siteOK = false;											$enregistrement = $b_pseudo && $b_mdp && $b_mdp2 && $b_mail && $b_mdpIdentique && $b_siteOK;										if (!$enregistrement)					{						echo '<p>Les quatre premiers champs doivent &ecirc;tre remplis !</p>';						if (!$b_mdpIdentique)							echo '<p>Vous avez saisi deux mots de passe diff&eacute;rent.</p>';						if (!$b_mail)							echo '<p>Votre adresse mail doit &ecirc;tre valide.</p>';						if (!$b_siteOK && $b_site)							echo '<p>L\'adresse de votre site doit commencer par http:// !</p>';						echo '<p><a href="inscription.php">S\'enregistrer.</a></p>';					}					else					{												$pseudo = htmlentities($_POST['pseudo'], ENT_QUOTES, 'UTF-8');						$citation = nl2br(htmlentities($_POST['citation'], ENT_QUOTES, 'UTF-8'));						$newsletter = (strcmp(htmlentities($_POST['news'], ENT_QUOTES, 'UTF-8'), 'oui') == 0) ? 1 : 0;												$resultat = $bdd->query('SELECT * FROM utilisateur WHERE pseudo="'.$pseudo.'"');						$ligne = $resultat->fetch();						if (!$ligne)						{							$requete = 'INSERT INTO utilisateur(pseudo, mdp, admin, mail, site, citation, newsletter) VALUES (\''.$pseudo.'\', \''.$mdp.'\', 0, \''.$mail.'\', \''.$site.'\', \''.$citation.'\', '.$newsletter.')';							$bdd->exec($requete);							$_SESSION['pseudo'] = $pseudo;							$_SESSION['mdp'] = $mdp;														$resultat = $bdd->query('SELECT * FROM utilisateur WHERE pseudo="'.$pseudo.'"');							$ligne = $resultat->fetch();							$_SESSION['admin'] = ($ligne['admin'] == 1);							$_SESSION['idpseudo'] = $ligne['id'];							$_SESSION['autorise'] = ($ligne['autorise'] == 1);							echo '<p>Vous &ecirc;tes maintenant inscrit(e) et connect&eacute;(e) !</p>';							if (isset($_POST['num_news']) && !empty($_POST['num_news']))							{								$num_news = intval($_POST['num_news']);								header('Location: commentaire.php?num_news='.$num_news);							}						}						else						{							echo '<p>Le pseudo que vous venez de saisir est d&eacute;j&agrave; utilis&eacute; !</p>';							echo '<p><a href="inscription.php">S\'enregistrer.</a></p>';						}					}				?>				</div>				<div id="actu">					<h3>Informations</h3>					<p>Votre inscription vous permet de participer &agrave; la vie du site et de recevoir des mails sur les derni&egrave;res versions de Fu(X). Votre adresse mail ne sera en aucun transmis &agrave; un service/entreprise tiers.</p>				</div>			</div>		</div>				<?php include("piedPage.php"); ?>			</body></html>